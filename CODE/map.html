<html>

<head>
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
	<meta charset="UTF-8">
    <title>OpenLayers Map</title>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=geometry&amp;sensor=false"></script>
    <!-- OpenLayers base script -->
    <script src="http://www.openlayers.org/api/OpenLayers.js"></script>
    <!-- <LINK href="style.css" rel="stylesheet" type="text/css"> -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script type="text/javascript">
        //<![CDATA[
        var map;
        var mercator = new OpenLayers.Projection("EPSG:900913");
        var geographic = new OpenLayers.Projection("EPSG:4326");
        var line_style = {
            strokeColor: "#0000EE",
            strokeOpacity: 0.7,
            strokeWidth: 4,
            pointRadius: 6,
            pointerEvents: "visiblePainted"
        };
        function init() {
            var options = {
                projection: mercator,
                displayProjection: geographic,
                units: "m",
                maxResolution: 156543.0339,
                maxExtent: new OpenLayers.Bounds(-20037508.34, -20037508.34, 20037508.34, 20037508.34),
                numZoomLevels: 1
            };
            map = new OpenLayers.Map('map', options);
            var osm = new OpenLayers.Layer.OSM();
            var gmap = new OpenLayers.Layer.Google("Google", {
                sphericalMercator: true
            });
            markers = new OpenLayers.Layer.Markers("points");
            map.addLayers([osm, gmap]);
            var polyline = new OpenLayers.Layer.Vector("Routes");
            map.addLayer(polyline);
            map.addLayer(markers);
            directionsService = new google.maps.DirectionsService();
            map.addControl(new OpenLayers.Control.LayerSwitcher());
            map.addControl(new OpenLayers.Control.MousePosition());
            map.setCenter(new OpenLayers.LonLat(18.4718, 54.37889).transform(geographic, mercator), 16);
            var click = new OpenLayers.Control.Click();
            map.addControl(click);
            click.activate();
            var events = map.events;
            events.register("mousedown", map, function(e) {
                //do smth
                return true;
            }, true);
        };
		function getGates()	// get list of available gates
			// return list of gates {id: idval, lon: lonval, lat: latval}
		{
			// wysyłamy String Gate
			$.ajax({
                    type: "GET",
                    dataType:"json",
                    contentType: "application/json; charset=utf-8",
                    url: "http://localhost:80/gate",
                    success: function(data1) {	// pobranie gatów
                        console.log(data1);
						myReceive(data1);
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        console.log(' Error in processing!');

                    }
                });
				
		}
		
		function sendChoosenGate(id) //send id of choosen gate
		{
			$.ajax({
				type: 'PUT',
				url: 'http://localhost:80/gate/'+id,
				success: function (data) {
					alert(data);
				}
			});
			
		}
		
		function getUpdate()
		{
			// dostajemy info ze zaszła zmiana
			$.ajax({
                    type: "GET",
                    dataType:"json",
                    contentType: "application/json; charset=utf-8",
                    url: "http://localhost:80/cgate",
                    success: function(chosenGate) {	// pobranie gatów
                        console.log(chosenGate);
						//obróbka dnayuch , tablica gatow
						
						//... wywołanie funkcji ktora wyswietli wybrany gate
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        console.log(' Error in processing!');

                    }
                });
		}
    </script>
</head>

<body onload="init()">
    <div id="map"></div>
    <div id="buttons"></div>
</body>

</html>